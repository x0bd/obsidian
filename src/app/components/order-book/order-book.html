<!-- ORDER BOOK -->
<div class="obs-panel obs-ob" role="region" aria-label="Order book">
  <div class="obs-panel-header">
    <span class="obs-panel-title">Order Book</span>
    <span class="label">L2</span>
  </div>

  <div class="obs-ob__col-header" aria-hidden="true">
    <span>Price</span><span>Size</span><span>Total</span>
  </div>

  <div class="obs-ob__side obs-ob__side--asks" aria-label="Ask orders">
    @for (row of svc.asks(); track row.price) {
      <div class="obs-ob__row" [attr.aria-label]="'Ask ' + row.price">
        <span class="obs-ob__price" style="color: var(--negative)">{{ row.price }}</span>
        <span class="obs-ob__size">{{ row.size }}</span>
        <span class="obs-ob__total">{{ row.total }}</span>
        <div
          class="depth-bar"
          aria-hidden="true"
          [style.width.%]="row.depthPct"
          style="background: var(--negative)"
        ></div>
      </div>
    }
  </div>

  <div class="obs-ob__spread" aria-label="Spread">1.0 spread</div>

  <div class="obs-ob__side obs-ob__side--bids" aria-label="Bid orders">
    @for (row of svc.bids(); track row.price) {
      <div class="obs-ob__row" [attr.aria-label]="'Bid ' + row.price">
        <span class="obs-ob__price" style="color: var(--positive)">{{ row.price }}</span>
        <span class="obs-ob__size">{{ row.size }}</span>
        <span class="obs-ob__total">{{ row.total }}</span>
        <div
          class="depth-bar"
          aria-hidden="true"
          [style.width.%]="row.depthPct"
          style="background: var(--positive)"
        ></div>
      </div>
    }
  </div>

  <div class="obs-ob__trades" role="region" aria-label="Recent trades" aria-live="polite">
    <div class="obs-panel-header" style="min-height: 36px">
      <span class="obs-panel-title">Trades</span>
    </div>
    @for (t of svc.recentTrades(); track t.id) {
      <div
        class="obs-ob__row obs-ob__row--trade"
        [class.obs-ob__row--whale]="t.isWhale"
        [attr.aria-label]="(t.isBid ? 'Buy' : 'Sell') + ' ' + t.price"
      >
        <span
          class="obs-ob__price"
          [style.color]="t.isBid ? 'var(--positive)' : 'var(--negative)'"
          >{{ t.price }}</span
        >
        <span class="obs-ob__size">{{ t.size }}</span>
        <span class="obs-ob__total">{{ t.time }}</span>
      </div>
    }
  </div>
</div>
