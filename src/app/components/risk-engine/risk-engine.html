<!-- RISK ENGINE -->
<div class="obs-panel obs-risk" role="region" aria-label="Risk engine">
  <div class="obs-panel-header">
    <span class="obs-panel-title">Risk</span>
  </div>

  <div class="obs-risk__body">
    <div class="obs-risk__metric">
      <div class="obs-risk__metric-row">
        <span class="label">Margin Usage</span>
        <span class="num-sm" [style.color]="marginWarning() ? 'var(--negative)' : 'var(--text-1)'">{{ marginLabel() }}</span>
      </div>
      <div
        class="obs-progress"
        role="progressbar"
        [attr.aria-valuenow]="svc.marginPct()"
        aria-valuemin="0"
        aria-valuemax="100"
      >
        <div
          class="obs-progress__fill"
          [style.width]="marginLabel()"
          [style.background]="marginWarning() ? 'var(--negative)' : 'var(--positive)'"
        ></div>
      </div>
    </div>

    <div class="obs-risk__metric">
      <div class="obs-risk__metric-row">
        <span class="label">Leverage</span>
        <span class="num-sm">10x</span>
      </div>
      <div class="obs-progress" role="progressbar" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
        <div class="obs-progress__fill" style="width:25%;background:var(--accent)"></div>
      </div>
    </div>

    <div class="obs-risk__divider"></div>

    <div class="obs-risk__equity">
      <span class="label">Account Equity</span>
      <span class="obs-risk__equity-value">{{ equityLabel() }}</span>
    </div>

    <div class="obs-risk__footer">
      @if (marginWarning()) {
        <div class="obs-vol-pill" role="alert">Margin Warning</div>
      } @else {
        <div class="obs-vol-pill obs-vol-pill--warn" role="status">High Volatility</div>
      }
    </div>
  </div>
</div>